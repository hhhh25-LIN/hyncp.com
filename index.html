<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ·±åœ³å¸‚å®ä¸šå†œäº§å“æœ‰é™å…¬å¸ - é¦–é¡µ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* åŒé€šé“æ ·å¼ */
    .channel-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin: 40px 0;
    }
    .channel-card {
      background: white;
      padding: 40px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
    }
    .channel-icon {
      font-size: 48px;
      margin-bottom: 20px;
      color: #3498db;
    }
    .channel-title {
      font-size: 24px;
      margin-bottom: 15px;
      color: #2c3e50;
    }
    .channel-desc {
      color: #666;
      margin-bottom: 30px;
      line-height: 1.6;
    }
    .channel-btn {
      padding: 12px 30px;
      font-size: 16px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }
    .channel-btn:hover {
      background-color: #2980b9;
    }
    .manager-channel .channel-icon,
    .manager-channel .channel-btn {
      background-color: #e74c3c;
    }
    .manager-channel .channel-btn:hover {
      background-color: #c0392b;
    }
    /* å•†å“å¡ç‰‡æŒ‰é’®ç»„ */
    .btn-group {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }
    /* åº•éƒ¨è”ç³»ä¿¡æ¯æ ·å¼ */
    .footer-contact {
      margin-top: 60px;
      padding: 20px;
      background: #f5f5f5;
      text-align: center;
      font-size: 16px;
      color: #333;
      border-top: 1px solid #eee;
    }
    .footer-address {
      margin-top: 10px;
      font-size: 15px;
      color: #555;
    }
    /* åˆ†ç±»ç­›é€‰æ ·å¼ */
    .category-filter {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      display: none;
    }
    .filter-title {
      font-size: 16px;
      margin-bottom: 10px;
      font-weight: bold;
    }
    .filter-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .filter-tag {
      padding: 5px 15px;
      border-radius: 20px;
      border: 1px solid #ddd;
      cursor: pointer;
      font-size: 14px;
    }
    .filter-tag.active {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
  </style>
</head>
<body>
  <div class="nav">
    <a href="index.html">é¦–é¡µ</a>
    <a href="cart.html">æˆ‘çš„è´­ç‰©è½¦</a>
  </div>

  <div class="container">
    <h2 style="text-align: center; color: #2c3e50; margin-top: 20px;">æ·±åœ³å¸‚å®ä¸šå†œäº§å“æœ‰é™å…¬å¸</h2>

    <!-- å®¢æˆ·/ç®¡ç†äººå‘˜åŒé€šé“ -->
    <div class="channel-container">
      <!-- å®¢æˆ·é€šé“ -->
      <div class="channel-card customer-channel">
        <div class="channel-icon">ğŸ›’</div>
        <h3 class="channel-title">å®¢æˆ·ä¸‹å•é€šé“</h3>
        <p class="channel-desc">æµè§ˆå•†å“åˆ—è¡¨ï¼Œæ·»åŠ åˆ°è´­ç‰©è½¦ï¼Œç»Ÿä¸€æäº¤è®¢å•åç­‰å¾…å·¥ä½œäººå‘˜è”ç³»</p>
        <a href="javascript:;" onclick="showProductList()" class="channel-btn">è¿›å…¥å•†å“åˆ—è¡¨</a>
      </div>

      <!-- ç®¡ç†äººå‘˜é€šé“ -->
      <div class="channel-card manager-channel">
        <div class="channel-icon">ğŸ”§</div>
        <h3 class="channel-title">ç®¡ç†äººå‘˜åå°</h3>
        <p class="channel-desc">ç™»å½•ç®¡ç†åå°ï¼Œæ·»åŠ /ç®¡ç†å•†å“ã€æŸ¥çœ‹å®¢æˆ·è®¢å•ã€ä¿®æ”¹ç®¡ç†å¯†ç </p>
        <a href="login.html" class="channel-btn">è¿›å…¥ç®¡ç†ç™»å½•</a>
      </div>
    </div>

    <!-- åˆ†ç±»ç­›é€‰åŒºåŸŸ -->
    <div class="category-filter" id="categoryFilter">
      <div class="filter-title">å•†å“åˆ†ç±»ç­›é€‰</div>
      <div class="filter-tags" id="filterTags">
        <div class="filter-tag active" data-id="all">å…¨éƒ¨</div>
      </div>
    </div>

    <!-- å•†å“åˆ—è¡¨ï¼ˆå¸¦æ·»åŠ è´­ç‰©è½¦åŠŸèƒ½ï¼‰ -->
    <div class="product-list" id="productList" style="margin-top: 20px; display: none;">
      <div class="product-item">
        <p>æš‚æ— å•†å“ï¼Œè¯·ç®¡ç†å‘˜å…ˆæ·»åŠ ~</p>
      </div>
    </div>

    <!-- åº•éƒ¨è”ç³»ä¿¡æ¯ï¼ˆç”µè¯+åœ°å€ï¼‰ -->
    <div class="footer-contact">
      å¦‚æœ‰ç–‘é—®è¯·æ‹¨æ‰“ç”µè¯ï¼š13528492168//13410033908
      <div class="footer-address">å…¬å¸åœ°å€ï¼šæ·±åœ³å¸‚é¾™å²—åŒºæ¨ªå²—è¡—é“å››è”ç¤¾åŒºé¢å‰å²­äº”å··ä¸‰å·ä¸€æ¥¼</div>
    </div>
  </div>

  <script>
    // æ˜¾ç¤ºå•†å“åˆ—è¡¨å’Œåˆ†ç±»ç­›é€‰
    function showProductList() {
      document.getElementById('categoryFilter').style.display = 'block';
      document.getElementById('productList').style.display = 'block';
      loadCategories();
      loadProducts();
    }

    // åŠ è½½åˆ†ç±»ç­›é€‰
    function loadCategories() {
      const filterTags = document.getElementById('filterTags');
      let categories = JSON.parse(localStorage.getItem('categories')) || [];
      
      // åŸºç¡€æ ‡ç­¾ï¼šå…¨éƒ¨
      let tagsHtml = '<div class="filter-tag active" data-id="all">å…¨éƒ¨</div>';
      
      // æ·»åŠ åˆ†ç±»æ ‡ç­¾
      if (categories.length > 0) {
        tagsHtml += categories.map(cat => `
          <div class="filter-tag" data-id="${cat.id}">${cat.name}</div>
        `).join('');
      } else {
        tagsHtml += '<div class="filter-tag disabled">æš‚æ— åˆ†ç±»</div>';
      }
      
      filterTags.innerHTML = tagsHtml;
      
      // ç»‘å®šåˆ†ç±»ç­›é€‰äº‹ä»¶
      document.querySelectorAll('.filter-tag').forEach(tag => {
        if (!tag.classList.contains('disabled')) {
          tag.addEventListener('click', function() {
            // åˆ‡æ¢æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            // ç­›é€‰å•†å“
            loadProducts(this.dataset.id);
          });
        }
      });
    }

    // åŠ è½½å•†å“åˆ—è¡¨ï¼ˆå¸¦åˆ†ç±»ç­›é€‰+æ·»åŠ è´­ç‰©è½¦åŠŸèƒ½ï¼‰
    function loadProducts(filterId = 'all') {
      const productList = document.getElementById('productList');
      const products = JSON.parse(localStorage.getItem('products')) || [];
      const categories = JSON.parse(localStorage.getItem('categories')) || [];
      
      // åˆ†ç±»ç­›é€‰
      let filteredProducts = products;
      if (filterId !== 'all') {
        filteredProducts = products.filter(p => p.categoryId === filterId);
      }
      
      if (filteredProducts.length === 0) {
        productList.innerHTML = '<div class="product-item"><p>æš‚æ— è¯¥åˆ†ç±»çš„å•†å“~</p></div>';
        return;
      }

      // æ¸²æŸ“å•†å“ï¼ˆæ˜¾ç¤ºåˆ†ç±»+æ·»åŠ è´­ç‰©è½¦æŒ‰é’®ï¼‰
      productList.innerHTML = filteredProducts.map(product => {
        // è·å–åˆ†ç±»åç§°
        const cat = categories.find(c => c.id === product.categoryId) || {name: 'æœªåˆ†ç±»'};
        return `
          <div class="product-item">
            <div class="product-name">${product.name}</div>
            <div>åˆ†ç±»ï¼š${cat.name}</div>
            <div class="product-price">Â¥ ${product.price}/${product.unit}</div>
            <div class="btn-group">
              <button class="btn btn-primary" onclick="addToCart('${product.id}')">åŠ å…¥è´­ç‰©è½¦</button>
              <a href="order-form.html?productId=${product.id}" class="btn btn-primary">ç«‹å³ä¸‹å•</a>
            </div>
          </div>
        `;
      }).join('');
    }

    // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
    function addToCart(productId) {
      const products = JSON.parse(localStorage.getItem('products')) || [];
      const product = products.find(p => p.id === productId);
      
      if (!product) {
        alert('å•†å“ä¸å­˜åœ¨ï¼');
        return;
      }

      // è·å–è´­ç‰©è½¦æ•°æ®
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      
      // æ£€æŸ¥å•†å“æ˜¯å¦å·²åœ¨è´­ç‰©è½¦
      const existingItem = cart.find(item => item.id === productId);
      if (existingItem) {
        // å·²å­˜åœ¨åˆ™æ•°é‡+1
        cart = cart.map(item => {
          if (item.id === productId) {
            return {...item, count: item.count + 1};
          }
          return item;
        });
      } else {
        // ä¸å­˜åœ¨åˆ™æ·»åŠ æ–°å•†å“ï¼ˆé»˜è®¤æ•°é‡1ï¼‰
        cart.push({
          id: product.id,
          name: product.name,
          price: product.price,
          unit: product.unit,
          categoryId: product.categoryId,
          count: 1
        });
      }

      // ä¿å­˜è´­ç‰©è½¦
      localStorage.setItem('cart', JSON.stringify(cart));
      alert(`${product.name} å·²åŠ å…¥è´­ç‰©è½¦ï¼`);
    }

    // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
    window.onload = function() {
      // åˆå§‹éšè—å•†å“åˆ—è¡¨å’Œåˆ†ç±»ç­›é€‰
      document.getElementById('categoryFilter').style.display = 'none';
      document.getElementById('productList').style.display = 'none';
    };
  </script>
</body>
</html>